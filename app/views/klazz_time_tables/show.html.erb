<%= title @klazz.name + ' - Time Table' %>

<%= navigation(@date) %>

<%= search(klazz_time_table_path(@klazz), @date) %>

<table id='calendar'>
  <tr>
    <%= content_tag :td, {class: 'time_cell', data: {klazz_id: @klazz.id}} {} %>
    <% @dates.each do |date| %>
      <%= content_tag :td, class: 'day_cell', data: {date: date} do %>
        <span class='bold'><%= Date::DAYNAMES[date.wday] %></span><br />
        <%= date.strftime('%-d/%-m/%Y') %>
      <% end %>
    <% end %>
  </tr>
  <% (0..15).each do |i| %>
    <tr>
      <%= content_tag :td, class: 'time_cell', data: {position: i} { @times[i] } %>
      <% @dates.each do |date| %>
        <td class='cell'>
          <% @klazz.find_time_tables_by_date_and_position(date, i).each do |time_table| %>
            <%= render 'time_tables/time_table', time_table: time_table %>
          <% end %>
          <%= render 'time_tables/empty_time_table' %>
        </td>
      <% end %>
    </tr>
  <% end %>
</table>

<div id='time_table_box'>
  <h2>Time Table</h2>
  <a id='close_form' href='#'>X</a>
  <%= render 'time_tables/form', time_table: TimeTable.new %>
</div>