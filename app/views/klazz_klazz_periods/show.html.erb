<%= title @klazz.name + ' - Time Table' %>

<%= navigation(@date) %>

<%= search(klazz_klazz_period_path(@klazz), @date) %>

<table id='calendar'>
  <tr>
    <%= content_tag :td, {class: 'time_cell', data: {klazz_id: @klazz.id}} {} %>
    <% @dates.each do |date| %>
      <%= content_tag :td, class: 'day_cell', data: {date: date} do %>
        <span class='bold'><%= Date::DAYNAMES[date.wday] %></span><br />
        <%= date.strftime('%-d/%-m/%Y') %>
      <% end %>
    <% end %>
  </tr>
  <% (0..15).each do |i| %>
    <tr>
      <%= content_tag :td, class: 'time_cell', data: {position: i} { @times[i] } %>
      <% @dates.each do |date| %>
        <td class='cell'>
          <% @klazz.find_klazz_periods_by_date_and_position(date, i).each do |klazz_period| %>
            <%= render 'klazz_periods/klazz_period', klazz_period: klazz_period %>
          <% end %>
          <%= render 'klazz_periods/empty_klazz_period' %>
        </td>
      <% end %>
    </tr>
  <% end %>
</table>

<div id='klazz_period_box'>
  <h2>Time Table</h2>
  <a id='close_form' href='#'>X</a>
  <%= render 'klazz_periods/form', klazz_period: TimeTable.new %>
</div>